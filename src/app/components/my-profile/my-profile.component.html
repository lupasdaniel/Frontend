<div class="profile-container">
  <!-- Profile Header -->
  <div class="profile-header">
    <div class="header-content">
      <div class="profile-avatar">
        <i class="pi pi-user"></i>
      </div>
      <div class="profile-info">
        <h1 class="profile-title">
          <i class="pi pi-user-edit"></i>
          Profilul meu
        </h1>
        <p class="profile-subtitle">Gestionează informațiile personale și rezervările</p>
      </div>
    </div>
  </div>

  <div class="content-grid">
    <!-- Personal Information Card -->
    <div class="profile-card">
      <div class="card-header">
        <h2>
          <i class="pi pi-id-card"></i>
          Informații personale
        </h2>
      </div>

      <form [formGroup]="editUserForm" (ngSubmit)="onSubmit()" class="profile-form">
        <div class="form-row">
          <div class="form-group">
            <label for="userName">
              <i class="pi pi-at"></i>
              Nume utilizator
            </label>
            <input
              id="userName"
              formControlName="userName"
              type="text"
              placeholder="Nume utilizator"
            />
          </div>

          <div class="form-group readonly">
            <label for="email">
              <i class="pi pi-envelope"></i>
              Email
            </label>
            <input
              id="email"
              formControlName="email"
              type="email"
              readonly
              placeholder="Adresa de email"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="firstName">
              <i class="pi pi-user"></i>
              Prenume *
            </label>
            <input
              id="firstName"
              formControlName="firstName"
              type="text"
              placeholder="Introdu prenumele"
            />
            <div *ngIf="editUserForm.get('firstName')?.invalid && editUserForm.get('firstName')?.touched" class="error-message">
              <i class="pi pi-exclamation-circle"></i>
              Prenumele este obligatoriu
            </div>
          </div>

          <div class="form-group">
            <label for="lastName">
              <i class="pi pi-user"></i>
              Nume *
            </label>
            <input
              id="lastName"
              formControlName="lastName"
              type="text"
              placeholder="Introdu numele"
            />
            <div *ngIf="editUserForm.get('lastName')?.invalid && editUserForm.get('lastName')?.touched" class="error-message">
              <i class="pi pi-exclamation-circle"></i>
              Numele este obligatoriu
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="phoneNumber">
            <i class="pi pi-phone"></i>
            Număr de telefon
          </label>
          <input
            id="phoneNumber"
            formControlName="phoneNumber"
            type="tel"
            placeholder="Introdu numărul de telefon"
          />
        </div>

        <div class="form-actions">
          <button
            type="submit"
            class="btn-save"
            [disabled]="editUserForm.invalid"
          >
            <i class="pi pi-save"></i>
            Salvează modificările
          </button>
        </div>
      </form>
    </div>

    <!-- Reservations Card -->
    <div class="reservations-card">
      <div class="card-header">
        <h2>
          <i class="pi pi-calendar"></i>
          Rezervările mele
        </h2>
        <div class="reservations-count" *ngIf="reservations.length > 0">
          {{ reservations.length }} {{ reservations.length === 1 ? 'rezervare' : 'rezervări' }}
        </div>
      </div>

      <div class="reservations-content">
        <div *ngIf="reservations.length === 0" class="no-reservations">
          <i class="pi pi-calendar-times"></i>
          <h3>Nu ai rezervări</h3>
          <p>Când vei face o rezervare, aceasta va apărea aici.</p>
        </div>

        <div *ngIf="reservations.length > 0" class="reservations-list">
          <div *ngFor="let res of reservations" class="reservation-card">
            <div class="reservation-info">
              <div class="reservation-main">
                <div class="table-info">
                  <i class="pi pi-th-large"></i>
                  <span class="table-number">Masa {{ res.tableNr }}</span>
                </div>
                <div class="date-info">
                  <i class="pi pi-calendar"></i>
                  <span class="date">{{ formatDateForQuery(res.date) }}</span>
                  <i class="pi pi-clock"></i>
                  <span class="time">{{ formatTimeForQuery(res.startTime) }}</span>
                </div>
              </div>

              <div class="reservation-details">
                <div class="detail-item">
                  <i class="pi pi-users"></i>
                  <span>{{ res.nrOfPersons }} {{ res.nrOfPersons === 1 ? 'persoană' : 'persoane' }}</span>
                </div>
                <div class="detail-item">
                  <i class="pi pi-home"></i>
                  <span>{{ res.roomName }}</span>
                </div>
              </div>
            </div>

            <div class="reservation-actions">
              <button
                class="btn-cancel"
                (click)="openConfirmDialog(res.id)"
                title="Anulează rezervarea"
              >
                <i class="pi pi-times"></i>
                Anulează
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Enhanced Confirmation Dialog -->
<div
  *ngIf="showConfirm"
  class="dialog-backdrop"
  (click)="closeConfirmDialog()"
>
  <div class="confirmation-dialog" (click)="$event.stopPropagation()">
    <div class="dialog-header">
      <i class="pi pi-exclamation-triangle"></i>
      <h3>Confirmare anulare</h3>
    </div>

    <div class="dialog-content">
      <p>Ești sigur că vrei să anulezi această rezervare?</p>
      <p class="warning-text">Această acțiune nu poate fi anulată.</p>
    </div>

    <div class="dialog-actions">
      <button class="btn-confirm" (click)="confirmCancel()">
        <i class="pi pi-check"></i>
        Da, anulează
      </button>
      <button class="btn-cancel-dialog" (click)="closeConfirmDialog()">
        <i class="pi pi-times"></i>
        Nu, păstrează
      </button>
    </div>
  </div>
</div>
