<div class="reservations-container">
  <!-- Page Header -->
  <div class="page-header">
    <h1>
      <i class="pi pi-calendar"></i>
      Gestionare rezervări
    </h1>
    <p>Administrează rezervările din sistem</p>
  </div>

  <div class="content-wrapper">
    <!-- Filters Card -->
    <div class="filters-card">
      <div class="filters-header">
        <h3>
          <i class="pi pi-filter"></i>
          Filtre
        </h3>
        <button
          type="button"
          class="reset-btn"
          (click)="resetFilters()"
          title="Resetează toate filtrele">
          <i class="pi pi-refresh"></i>
          Reset
        </button>
      </div>

      <div class="filter-group">
        <label for="filterDate">
          <i class="pi pi-calendar"></i>
          Data rezervării
        </label>
        <p-datePicker
          [(ngModel)]="filters.date"
          placeholder="Selectează data"
          name="filterDate"
          showIcon="true"
          dateFormat="yy-mm-dd"
          appendTo="body">
        </p-datePicker>
      </div>

      <div class="filter-group">
        <label for="filterTime">
          <i class="pi pi-clock"></i>
          Ora rezervării
        </label>
        <p-calendar
          [(ngModel)]="filters.time"
          name="filterTime"
          placeholder="Selectează ora"
          timeOnly="true"
          hourFormat="24"
          showIcon="true"
          appendTo="body">
        </p-calendar>
      </div>

      <div class="filter-group">
        <label for="filterRoom">
          <i class="pi pi-home"></i>
          Nume cameră
        </label>
        <input
          id="filterRoom"
          type="text"
          placeholder="Caută după nume cameră"
          [(ngModel)]="filters.roomName"
          name="filterRoomName"
          (input)="loadReservations()"
        />
      </div>

      <div class="filter-actions">
        <button
          type="button"
          class="apply-btn"
          (click)="applyFilters()">
          <i class="pi pi-search"></i>
          Aplică filtre
        </button>
      </div>
    </div>

    <!-- Reservations Table Card -->
    <div class="table-card">
      <div class="card-header">
        <h3>
          <i class="pi pi-list"></i>
          Lista rezervărilor
        </h3>
        @if (reservations.length > 0) {
          <div class="reservations-count">
            {{ reservations.length }} {{ reservations.length === 1 ? 'rezervare' : 'rezervări' }}
          </div>
        }
      </div>

      @if (reservations.length === 0) {
        <div class="no-reservations">
          <i class="pi pi-calendar"></i>
          <h3>Nu există rezervări</h3>
          <p>Nu s-au găsit rezervări care să corespundă filtrelor aplicate.</p>
        </div>
      } @else {
        <div class="reservations-grid">
          @for (reservation of reservations; track reservation.id) {
            <div class="reservation-card">
              <div class="reservation-header">
                <div class="reservation-date">
                  <i class="pi pi-calendar"></i>
                  {{ reservation.date | date:'dd.MM.yyyy' }}
                </div>
                <div class="reservation-time">
                  <i class="pi pi-clock"></i>
                  {{ reservation.startTime }}
                </div>
              </div>

              <div class="reservation-details">
                <div class="detail-item">
                  <div class="detail-label">Masa</div>
                  <div class="detail-value">Nr. {{ reservation.tableNr }}</div>
                </div>
                <div class="detail-item">
                  <div class="detail-label">Cameră</div>
                  <div class="detail-value">{{ reservation.roomName }}</div>
                </div>
                <div class="detail-item">
                  <div class="detail-label">Durata</div>
                  <div class="detail-value">{{ reservation.duration }}</div>
                </div>
                <div class="detail-item">
                  <div class="detail-label">Nr. persoane</div>
                  <div class="detail-value">{{ reservation.nrOfPersons }}</div>
                </div>
              </div>

              @if (reservation.specifications && reservation.specifications.trim() !== '') {
                <div class="specifications">
                  <div class="spec-label">
                    <i class="pi pi-info-circle"></i>
                    Specificații
                  </div>
                  <div class="spec-text">{{ reservation.specifications }}</div>
                </div>
              }

              <div class="client-info">
                <div class="client-header">
                  <i class="pi pi-user"></i>
                  Informații client
                </div>
                <div class="client-details">
                  <div class="client-item">
                    <i class="pi pi-envelope"></i>
                    {{ reservation.clientEmail }}
                  </div>
                  <div class="client-item">
                    <i class="pi pi-phone"></i>
                    {{ reservation.clientPhoneNumber }}
                  </div>
                </div>
              </div>

              <div class="reservation-actions">
                <button
                  class="cancel-btn"
                  (click)="openConfirmDialog(reservation.id)"
                  title="Anulează rezervarea">
                  <i class="pi pi-times"></i>
                  Anulează rezervarea
                </button>
              </div>
            </div>
          }
        </div>
      }
    </div>
  </div>
</div>

<!-- Confirm Cancel Dialog -->
@if (showConfirm) {
  <div class="confirm-dialog-backdrop">
    <div class="confirm-dialog">
      <p>Ești sigur că vrei să anulezi această rezervare?</p>
      <div class="dialog-buttons">
        <button class="btn-confirm" (click)="confirmCancel()">
          <i class="pi pi-check"></i>
          Da, anulează
        </button>
        <button class="btn-cancel-dialog" (click)="closeConfirmDialog()">
          <i class="pi pi-times"></i>
          Nu, păstrează
        </button>
      </div>
    </div>
  </div>
}
